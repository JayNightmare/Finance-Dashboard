{% extends "base.html" %}
{% block title %}Budgets{% endblock %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1>Budgets</h1>
    <a href="{% url 'core:budget-create' %}" class="btn btn-primary">Add Budget</a>
  </div>

  <div class="row g-4">
    {% for row in budget_progress %}
      <div class="col-md-6">
        <div class="card h-100">
          <div class="card-body">
            <h5 class="card-title">{{ row.budget.category.name }} â€” {{ row.budget.start_month|date:"F Y" }}</h5>
            <p class="card-text mb-1">Budget: {{ row.budget.amount|floatformat:2 }}</p>
            <p class="card-text mb-3">Spent: {{ row.spent|floatformat:2 }} ({{ row.percentage }}%)</p>
            <div class="progress mb-3" style="height: 20px;">
              <div
                class="progress-bar {% if row.percentage >= 100 %}bg-danger{% elif row.percentage >= 80 %}bg-warning{% else %}bg-success{% endif %}"
                role="progressbar"
                style="width: {{ row.percentage }}%;"
                aria-valuenow="{{ row.percentage }}"
                aria-valuemin="0"
                aria-valuemax="100"
              >
                {{ row.percentage }}%
              </div>
            </div>
            <p class="card-text">Remaining: {{ row.remaining|floatformat:2 }}</p>
          </div>
          <div class="card-footer d-flex justify-content-between">
            <a href="{% url 'core:budget-update' row.budget.pk %}" class="btn btn-sm btn-outline-primary">Edit</a>
            <a href="{% url 'core:budget-delete' row.budget.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
          </div>
        </div>
      </div>
    {% empty %}
      <div class="col-12">
        <div class="alert alert-info">No budgets yet. Create one to track your spending.</div>
      </div>
    {% endfor %}
  </div>
{% endblock %}
